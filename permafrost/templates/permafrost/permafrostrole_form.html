{% extends "permafrost/base.html" %}
{% load i18n %}
{% load static %}

{% block title %}{% trans 'Create Role' %}{% endblock %}

{% block content %}
<form method="POST" id="role_form">
    {% csrf_token %}
    <h1>
        {% if object %}
            {% trans 'Edit Permissions' %}: {{ form.initial.name }}
        {% else %}
            {% trans 'Create Role' %}
        {% endif %}
    </h1>
    <div class="card">
        <div class="card-body">
            <table>
                {{ form.as_table }}
            </table>
        </div>
        <div class="card-footer">
            <a href="{% url 'permafrost:role-list' %}" class="btn btn-warning">{% trans 'Cancel' %}</a>
            <button type="submit" class="btn btn-primary">
                {% if object %}
                    {% trans 'Save' %}                
                {% else %}
                    {% trans 'Create' %}    
                {% endif %}
            </button>
        </div>
    </div>
    
    
    {% comment %}
    <h3>Perms:</h3>
    <ul>
        {% for perm in object.optional_permissions %}
        <li>{{perm.name}}</li>
        {% endfor %}
    </ul>
    {% endcomment %}
</form>
{% endblock %}


{% block extra_js %}
    {% if not object %} {# "Hide JS change handler on edit " #}
    <script>
        $(document).ready(function(){
            $('#id_category').on('change', function(){
                $(this)
                .closest('form')
                .attr('action', "{% url 'permafrost:role-select' %}")
                .submit()
            })
        })
    </script>
    {% endif %}
{% endblock %}
    